/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var t={58394:function(t,e,n){t.exports=n.p+"ded29c7644ceac0302e4.css"},98362:function(t,e,n){t.exports=n.p+"assets/logo-filled.png"}},e={};function n(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,n),a.exports}n.m=t,n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=r[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function t(){var n,r,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",c=o.toStringTag||"@@toStringTag";function i(t,o,a,c){var i=o&&o.prototype instanceof s?o:s,f=Object.create(i.prototype);return e(f,"_invoke",function(t,e,o){var a,c,i,s=0,f=o||[],l=!1,p={p:0,n:0,v:n,a:m,f:m.bind(n,4),d:function(t,e){return a=t,c=0,i=n,p.n=e,u}};function m(t,e){for(c=t,i=e,r=0;!l&&s&&!o&&r<f.length;r++){var o,a=f[r],m=p.p,b=a[2];t>3?(o=b===e)&&(i=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=n):a[0]<=m&&((o=t<2&&m<a[1])?(c=0,p.v=e,p.n=a[1]):m<b&&(o=t<3||a[0]>e||e>b)&&(a[4]=t,a[5]=e,p.n=b,c=0))}if(o||t>1)return u;throw l=!0,e}return function(o,f,b){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&m(f,b),c=f,i=b;(r=c<2?n:i)||!l;){a||(c?c<3?(c>1&&(p.n=-1),m(c,i)):p.n=i:p.v=i);try{if(s=2,a){if(c||(o="next"),r=a[o]){if(!(r=r.call(a,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,c<2&&(c=0)}else 1===c&&(r=a.return)&&r.call(a),c<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=n}else if((r=(l=p.n<0)?i:t.call(e,p))!==u)break}catch(t){a=n,c=1,i=t}finally{s=1}}return{value:r,done:l}}}(t,a,c),!0),f}var u={};function s(){}function f(){}function l(){}r=Object.getPrototypeOf;var p=[][a]?r(r([][a]())):(e(r={},a,function(){return this}),r),m=l.prototype=s.prototype=Object.create(p);function b(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,e(t,c,"GeneratorFunction")),t.prototype=Object.create(m),t}return f.prototype=l,e(m,"constructor",l),e(l,"constructor",f),f.displayName="GeneratorFunction",e(l,c,"GeneratorFunction"),e(m),e(m,c,"Generator"),e(m,a,function(){return this}),e(m,"toString",function(){return"[object Generator]"}),(t=function(){return{w:i,m:b}})()}function e(t,n,r,o){var a=Object.defineProperty;try{a({},"",{})}catch(t){a=0}e=function(t,n,r,o){function c(n,r){e(t,n,function(t){return this._invoke(n,r,t)})}n?a?a(t,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[n]=r:(c("next",0),c("throw",1),c("return",2))},e(t,n,r,o)}function n(t,e,n,r,o,a,c){try{var i=t[a](c),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,o)}function r(t){return function(){var e=this,r=arguments;return new Promise(function(o,a){var c=t.apply(e,r);function i(t){n(c,o,a,i,u,"next",t)}function u(t){n(c,o,a,i,u,"throw",t)}i(void 0)})}}function o(){return a.apply(this,arguments)}function a(){return a=r(t().m(function e(){var n;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=r(t().m(function e(n){var r,o,a;return t().w(function(t){for(;;)switch(t.n){case 0:return(r=n.workbook.tables).load("items"),t.n=1,n.sync();case 1:if(!r.items.some(function(t){return"EbarimtTable"===t.name})){t.n=2;break}return m("Table 'EbarimtTable' already exists!"),t.a(2);case 2:return o=n.workbook.worksheets.getActiveWorksheet(),(a=o.tables.add("A1:D1",!0)).name="EbarimtTable",a.getHeaderRowRange().values=[["РД","Нэр","Tin Дугаар","msg"]],a.getRange().format.autofitColumns(),a.getRange().format.autofitRows(),t.n=3,n.sync();case 3:m("Table created successfully!");case 4:return t.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error(n),m("Error creating table: "+n.message);case 3:return e.a(2)}},e,null,[[0,2]])})),a.apply(this,arguments)}function c(){return i.apply(this,arguments)}function i(){return i=r(t().m(function e(){var n;return t().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Excel.run(function(){var e=r(t().m(function e(n){var r,o,a,c,i,s,l,p,b;return t().w(function(t){for(;;)switch(t.n){case 0:return(r=n.workbook.tables).load("items"),t.n=1,n.sync();case 1:if(r.items.some(function(t){return"EbarimtTable"===t.name})){t.n=2;break}return m("Please create the table first by clicking 'Талбар нээх'."),t.a(2);case 2:return o=n.workbook.tables.getItem("EbarimtTable"),(a=o.getDataBodyRange()).load(["values","rowCount"]),t.n=3,n.sync();case 3:c=a.rowCount,i=0;case 4:if(!(i<c)){t.n=9;break}if(s=a.values[i][0]){t.n=5;break}return t.a(3,8);case 5:return t.n=6,u(s);case 6:return l=t.v,t.n=7,f(l.tin);case 7:p=t.v,a.getCell(i,1).values=[[p.name||""]],(b=a.getCell(i,2)).values=[[l.tin||""]],b.numberFormat=[["0"]],a.getCell(i,3).values=[[p.msg||l.msg||""]];case 8:i++,t.n=4;break;case 9:return t.n=10,n.sync();case 10:o.getRange().format.autofitColumns(),o.getRange().format.autofitRows(),m("Data filled successfully!");case 11:return t.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}());case 1:e.n=3;break;case 2:e.p=2,n=e.v,console.error("Error in runFill:",n),m("Error: "+n.message);case 3:return e.a(2)}},e,null,[[0,2]])})),i.apply(this,arguments)}function u(t){return s.apply(this,arguments)}function s(){return(s=r(t().m(function e(n){var r,o,a;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,r="https://api.ebarimt.mn/api/info/check/getTinInfo?regNo=".concat(n),t.n=1,fetch(r);case 1:return o=t.v,t.n=2,o.json();case 2:return a=t.v,t.a(2,{tin:a.data||"",msg:a.msg||""});case 3:return t.p=3,t.v,t.a(2,{tin:"",msg:"Error fetching TIN"})}},e,null,[[0,3]])}))).apply(this,arguments)}function f(t){return l.apply(this,arguments)}function l(){return(l=r(t().m(function e(n){var r,o,a,c;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,o="https://api.ebarimt.mn/api/info/check/getInfo?tin=".concat(n),t.n=1,fetch(o);case 1:return a=t.v,t.n=2,a.json();case 2:return c=t.v,t.a(2,{name:(null===(r=c.data)||void 0===r?void 0:r.name)||"",msg:c.msg||""});case 3:return t.p=3,t.v,t.a(2,{name:"",msg:"Error fetching name"})}},e,null,[[0,3]])}))).apply(this,arguments)}function p(){return(p=r(t().m(function e(n){var r;return t().w(function(t){for(;;)switch(t.p=t.n){case 0:return t.p=0,t.n=1,n();case 1:t.n=3;break;case 2:t.p=2,r=t.v,console.error(r);case 3:return t.a(2)}},e,null,[[0,2]])}))).apply(this,arguments)}function m(t){var e=document.getElementById("item-subject");e&&(e.textContent=t,setTimeout(function(){return e.textContent=""},5e3))}Office.onReady(function(t){if(t.host===Office.HostType.Excel){var e=document.getElementById("sideload-msg"),n=document.getElementById("app-body"),r=document.getElementById("run-fill"),a=document.getElementById("create-table");e&&(e.style.display="none"),n&&(n.style.display="flex"),r&&(r.onclick=c),a&&(a.onclick=function(){return function(t){return p.apply(this,arguments)}(o)})}})}(),new URL(n(58394),n.b),new URL(n(98362),n.b)}();
//# sourceMappingURL=taskpane.js.map